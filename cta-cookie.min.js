"use strict";const cookieConfig={mode:"opt-in",cookieMaxAge:180,debugMode:!1,consentMode:!0,categories:{essential:!0,analytics:!1,marketing:!1,personalization:!1,uncategorized:!1}};function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("consent","default",{ad_storage:"denied",analytics_storage:"denied",functionality_storage:"denied",personalization_storage:"denied",security_storage:"granted",wait_for_update:500});const cookieManager={setCookie:(e,o,t)=>{let n="";if(t){const e=new Date;e.setTime(e.getTime()+24*t*60*60*1e3),n="; expires="+e.toUTCString()}document.cookie=e+"="+(o||"")+n+"; path=/; SameSite=None; Secure"},getCookie:e=>{const o=e+"=",t=document.cookie.split("; ");for(let e=0;e<t.length;e++){let n=t[e];for(;" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(o))return n.substring(o.length,n.length)}return null},eraseCookie:e=>{document.cookie=e+"=; Max-Age=-99999999; path=/; SameSite=None; Secure"},clearAllCookies:()=>{const e=document.cookie.split("; ");for(let o=0;o<e.length;o++){const t=e[o].split("=")[0];document.cookie=t+"=; Max-Age=-99999999; path=/; SameSite=None; Secure"}},clearTrackingCookies:()=>{let e=window.location.hostname.split(".").slice(-2).join(".");["_ga","_gid","_gat","_gac_","_gtm","_gcl_au"].forEach((o=>{document.cookie=`${o}=; Max-Age=0; path=/; domain=${e}; SameSite=None; Secure`,document.cookie=`${o}=; Max-Age=0; path=/; SameSite=None; Secure`}))}},resetCookies=()=>{cookieManager.clearAllCookies(),cookieManager.clearTrackingCookies(),closeCookiePreferences(),console.log("Tutti i cookie sono stati cancellati e il banner Ã¨ stato chiuso."),location.reload()},resetButton=document.querySelector("[cta='reset']");resetButton&&resetButton.addEventListener("click",resetCookies);const uiManager={showBanner:()=>{document.querySelector("#banner-cookie")&&animateBanner()},hideBanner:()=>{document.querySelector("#banner-cookie")&&animateBannerClose()},closeBannerWithoutConsent:()=>{document.querySelector("#banner-cookie")&&animateBannerClose()},handlePreferences:()=>{document.querySelector("#cookie-preferences")&&cookiePreferences()}};cookieManager.getCookie("cta")||uiManager.showBanner();const consentManager={allowAll:()=>{gtag("consent","update",{ad_storage:"granted",analytics_storage:"granted",functionality_storage:"granted",personalization_storage:"granted"}),cookieManager.setCookie("cta",JSON.stringify({essential:!0,analytics:!0,marketing:!0,personalization:!0}),cookieConfig.cookieMaxAge),gtmManager.fireGTMEvent("allCookiesAccepted"),activateScripts(),uiManager.hideBanner(),closeCookiePreferences()},denyAll:()=>{gtag("consent","update",{ad_storage:"denied",analytics_storage:"denied",functionality_storage:"denied",personalization_storage:"denied"});cookieManager.setCookie("cta",JSON.stringify({essential:!0,analytics:!1,marketing:!1,personalization:!1}),cookieConfig.cookieMaxAge),cookieManager.clearTrackingCookies(),gtmManager.fireGTMEvent("allCookiesDenied"),uiManager.hideBanner(),closeCookiePreferences()},handleFormSubmit:e=>{e.preventDefault();const o=document.querySelector("#cookie-analytics"),t=document.querySelector("#cookie-marketing"),n=document.querySelector("#cookie-personalization"),a=!!o&&o.checked,i=!!t&&t.checked,r=!!n&&n.checked;gtag("consent","update",{ad_storage:i?"granted":"denied",analytics_storage:a?"granted":"denied",functionality_storage:r?"granted":"denied"});const c={essential:!0,analytics:a,marketing:i,personalization:r};cookieManager.setCookie("cta",JSON.stringify(c),cookieConfig.cookieMaxAge),(a||i)&&activateScripts(),gtmManager.updateConsentMode(c),closeCookiePreferences()}},allowButtons=document.querySelectorAll("[cta='allow']");allowButtons.length>0&&allowButtons.forEach((e=>{e.addEventListener("click",consentManager.allowAll)}));const denyButtons=document.querySelectorAll("[cta='deny']");function activateScripts(){const scripts=document.querySelectorAll('script[cta="activate"]');scripts.forEach((script=>{if(script.removeAttribute("type"),script.src){const e=document.createElement("script");e.async=script.async,e.src=script.src,document.head.appendChild(e)}else eval(script.innerText)}))}function initializeTracking(){const e=JSON.parse(cookieManager.getCookie("cta"))||{essential:!0,analytics:!1,marketing:!1,personalization:!1};(e.analytics||e.marketing)&&activateScripts()}function animateBanner(){const e=document.getElementById("banner-cookie");e&&gsap.fromTo(e,{y:"10rem",display:"none"},{y:"0rem",display:"flex",duration:1,delay:3,ease:"power2.inOut"})}function animateBannerClose(){const e=document.querySelector("#banner-cookie");e&&gsap.to(e,{y:"10rem",duration:.5,ease:"power2.inOut",onComplete:()=>{e.style.display="none"}})}function cookiePreferences(){const e=document.querySelector("#cookie-preferences");e&&(e.style.display="flex",gsap.to(e,{opacity:1,duration:.5,ease:"power2.inOut"}))}function closeCookiePreferences(){const e=document.querySelector("#cookie-preferences");e&&gsap.to(e,{opacity:0,duration:.5,ease:"power2.inOut",onComplete:()=>{e.style.display="none"}})}denyButtons.length>0&&denyButtons.forEach((e=>{e.addEventListener("click",consentManager.denyAll)})),document.addEventListener("DOMContentLoaded",initializeTracking),document.addEventListener("DOMContentLoaded",(()=>{const toggleCheckboxAnimation=(e,o,t,n,a)=>{const i=document.querySelector(e),r=document.querySelector(`[cta-checkbox='${o}']`),c=r?.querySelector(`[cta-toggle='${t}']`);i&&r&&c?(i.checked=a,a?(gsap.to(c,{x:20,duration:.3,ease:"power2.inOut"}),gsap.to(r,{backgroundColor:"#ff006e",duration:.3,ease:"power2.inOut"})):(gsap.to(c,{x:0,duration:.3,ease:"power2.inOut"}),gsap.to(r,{backgroundColor:"",duration:.3,ease:"power2.inOut"})),i.addEventListener("click",(()=>{i.checked?(gsap.to(c,{x:20,duration:.3,ease:"power2.inOut"}),gsap.to(r,{backgroundColor:"#ff006e",duration:.3,ease:"power2.inOut"})):(gsap.to(c,{x:0,duration:.3,ease:"power2.inOut"}),gsap.to(r,{backgroundColor:"",duration:.3,ease:"power2.inOut"}));const e=JSON.parse(cookieManager.getCookie("cta"))||{essential:!0,analytics:!1,marketing:!1,personalization:!1};e[n]=i.checked,cookieManager.setCookie("cta",JSON.stringify(e),cookieConfig.cookieMaxAge),gtag("consent","update",{ad_storage:e.marketing?"granted":"denied",analytics_storage:e.analytics?"granted":"denied",functionality_storage:e.personalization?"granted":"denied"})}))):console.warn(`Elemento non trovato per l'animazione del checkbox: ${n}`)},toggleAllCheckboxes=e=>{toggleCheckboxAnimation("#cookie-marketing","marketing","marketing","marketing",e),toggleCheckboxAnimation("#cookie-analytics","analytics","analytics","analytics",e),toggleCheckboxAnimation("#cookie-personalization","personalization","personalization","personalization",e);const o={essential:!0,analytics:e,marketing:e,personalization:e};cookieManager.setCookie("cta",JSON.stringify(o),cookieConfig.cookieMaxAge)},e=document.querySelectorAll("[cta='allow']");e.length>0&&e.forEach((e=>{e.addEventListener("click",(()=>{toggleAllCheckboxes(!0),uiManager.hideBanner()}))}));const o=document.querySelectorAll("[cta='deny']");o.length>0&&o.forEach((e=>{e.addEventListener("click",(()=>{toggleAllCheckboxes(!1),uiManager.hideBanner()}))}));const t=JSON.parse(cookieManager.getCookie("cta"))||{essential:!0,analytics:!1,marketing:!1,personalization:!1};toggleCheckboxAnimation("#cookie-marketing","marketing","marketing","marketing",t.marketing),toggleCheckboxAnimation("#cookie-analytics","analytics","analytics","analytics",t.analytics),toggleCheckboxAnimation("#cookie-personalization","personalization","personalization","personalization",t.personalization)}));