"use strict";const cookieConfig={mode:"opt-in",cookieMaxAge:180,debugMode:!1,consentMode:!0,categories:{essential:!0,analytics:!1,marketing:!1,personalization:!1,uncategorized:!1}};function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("consent","default",{ad_storage:"denied",analytics_storage:"denied",functionality_storage:"denied",wait_for_update:500});const cookieManager={setCookie:(e,o,n)=>{let t="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),t="; expires="+e.toUTCString()}document.cookie=`${e}=${o||""}${t}; path=/; SameSite=None; Secure`},getCookie:e=>{const o=`${e}=`,n=document.cookie.split("; ");for(let e of n)if(0===e.indexOf(o))return e.substring(o.length);return null},eraseCookie:e=>{document.cookie=`${e}=; Max-Age=-99999999; path=/; SameSite=None; Secure`},clearAllCookies:()=>{document.cookie.split("; ").forEach((e=>{const o=e.split("=")[0];document.cookie=`${o}=; Max-Age=-99999999; path=/; SameSite=None; Secure`}))},clearTrackingCookies:()=>{const e=window.location.hostname.split(".").slice(-2).join(".");["_ga","_gid","_gat","_gac_","_gtm","_gcl_au"].forEach((o=>{document.cookie=`${o}=; Max-Age=0; path=/; domain=${e}; SameSite=None; Secure`,document.cookie=`${o}=; Max-Age=0; path=/; SameSite=None; Secure`}))}},resetCookies=()=>{cookieManager.clearAllCookies(),cookieManager.clearTrackingCookies(),closeCookiePreferences(),console.log("Tutti i cookie sono stati cancellati e il banner Ã¨ stato chiuso."),location.reload()},resetButton=document.querySelector("[cta='reset']");resetButton&&resetButton.addEventListener("click",resetCookies);const uiManager={showBanner:()=>{document.querySelector("#banner-cookie")&&animateBanner()},hideBanner:()=>{document.querySelector("#banner-cookie")&&animateBannerClose()},closeBannerWithoutConsent:()=>{document.querySelector("#banner-cookie")&&animateBannerClose()},handlePreferences:()=>{document.querySelector("#cookie-preferences")&&cookiePreferences()}};cookieManager.getCookie("cta")||uiManager.showBanner();const consentManager={allowAll:()=>{gtag("consent","update",{ad_storage:"granted",analytics_storage:"granted",functionality_storage:"granted"}),cookieManager.setCookie("cta",JSON.stringify({essential:!0,analytics:!0,marketing:!0,personalization:!0}),cookieConfig.cookieMaxAge),gtmManager.fireGTMEvent("allCookiesAccepted"),activateScripts(),uiManager.hideBanner(),closeCookiePreferences()},denyAll:()=>{gtag("consent","update",{ad_storage:"denied",analytics_storage:"denied",functionality_storage:"denied"});cookieManager.setCookie("cta",JSON.stringify({essential:!0,analytics:!1,marketing:!1,personalization:!1}),cookieConfig.cookieMaxAge),cookieManager.clearTrackingCookies(),gtmManager.fireGTMEvent("allCookiesDenied"),uiManager.hideBanner(),closeCookiePreferences()},handleFormSubmit:e=>{e.preventDefault();const o=document.querySelector("#cookie-analytics")?.checked||!1,n=document.querySelector("#cookie-marketing")?.checked||!1,t=document.querySelector("#cookie-personalization")?.checked||!1;gtag("consent","update",{ad_storage:n?"granted":"denied",analytics_storage:o?"granted":"denied",functionality_storage:t?"granted":"denied"});const a={essential:!0,analytics:o,marketing:n,personalization:t};cookieManager.setCookie("cta",JSON.stringify(a),cookieConfig.cookieMaxAge),(o||n)&&activateScripts(),gtmManager.updateConsentMode(a),closeCookiePreferences()}};document.querySelectorAll("[cta='allow']").forEach((e=>e.addEventListener("click",consentManager.allowAll))),document.querySelectorAll("[cta='deny']").forEach((e=>e.addEventListener("click",consentManager.denyAll))),document.querySelectorAll("[cta='open-preferences']").forEach((e=>{e.addEventListener("click",(()=>{uiManager.closeBannerWithoutConsent(),uiManager.handlePreferences()}))}));const preferencesForm=document.querySelector("#wf-form-Cookie-Preferences-form");preferencesForm&&preferencesForm.addEventListener("submit",consentManager.handleFormSubmit);const preferencesCloseButton=document.querySelector("#preferences-close");preferencesCloseButton&&preferencesCloseButton.addEventListener("click",closeCookiePreferences);const submitButton=document.querySelector("[cta='submit']");submitButton&&submitButton.addEventListener("click",(e=>{e.preventDefault(),consentManager.handleFormSubmit(e)}));const closeButton=document.querySelector("#banner-close");closeButton&&closeButton.addEventListener("click",uiManager.closeBannerWithoutConsent);const gtmManager={fireGTMEvent:e=>{window.dataLayer&&(window.dataLayer.push({event:e}),cookieConfig.debugMode&&console.log(`Evento GTM ${e} inviato.`))},updateConsentMode:e=>{cookieConfig.consentMode&&window.gtag&&(window.gtag("consent","update",{ad_storage:e.marketing?"granted":"denied",analytics_storage:e.analytics?"granted":"denied",functionality_storage:e.personalization?"granted":"denied"}),cookieConfig.debugMode&&console.log("Google Consent Mode aggiornato:",e))}};function activateScripts(){document.querySelectorAll('script[cta="activate"]').forEach((script=>{if(script.removeAttribute("type"),script.src){const e=document.createElement("script");e.async=!0,e.src=script.src,document.head.appendChild(e)}else eval(script.innerText)}))}function initializeTracking(){const e=JSON.parse(cookieManager.getCookie("cta"))||{essential:!0,analytics:!1,marketing:!1,personalization:!1};(e.analytics||e.marketing)&&activateScripts()}function animateBanner(){const e=document.getElementById("banner-cookie");e&&gsap.fromTo(e,{y:"10rem",display:"none"},{y:"0rem",display:"flex",duration:1,delay:3,ease:"power2.inOut"})}function animateBannerClose(){const e=document.querySelector("#banner-cookie");e&&gsap.to(e,{y:"10rem",duration:.5,ease:"power2.inOut",onComplete:()=>{e.style.display="none"}})}function cookiePreferences(){const e=document.querySelector("#cookie-preferences");e&&(e.style.display="flex",gsap.to(e,{opacity:1,duration:.5,ease:"power2.inOut"}))}function closeCookiePreferences(){const e=document.querySelector("#cookie-preferences");e&&gsap.to(e,{opacity:0,duration:.5,ease:"power2.inOut",onComplete:()=>{e.style.display="none"}})}document.addEventListener("DOMContentLoaded",initializeTracking),document.addEventListener("DOMContentLoaded",(()=>{const toggleCheckboxAnimation=(e,o,n,t,a)=>{const i=document.querySelector(e),c=document.querySelector(`[cta-checkbox='${o}']`),r=c?.querySelector(`[cta-toggle='${n}']`);i&&c&&r?(i.checked=a,a?(gsap.to(r,{x:20,duration:.3,ease:"power2.inOut"}),gsap.to(c,{backgroundColor:"#ff006e",duration:.3,ease:"power2.inOut"})):(gsap.to(r,{x:0,duration:.3,ease:"power2.inOut"}),gsap.to(c,{backgroundColor:"",duration:.3,ease:"power2.inOut"})),i.addEventListener("click",(()=>{i.checked?(gsap.to(r,{x:20,duration:.3,ease:"power2.inOut"}),gsap.to(c,{backgroundColor:"#ff006e",duration:.3,ease:"power2.inOut"})):(gsap.to(r,{x:0,duration:.3,ease:"power2.inOut"}),gsap.to(c,{backgroundColor:"",duration:.3,ease:"power2.inOut"}));const e=JSON.parse(cookieManager.getCookie("cta"))||{essential:!0,analytics:!1,marketing:!1,personalization:!1};e[t]=i.checked,cookieManager.setCookie("cta",JSON.stringify(e),cookieConfig.cookieMaxAge)}))):console.warn(`Elemento non trovato per l'animazione del checkbox: ${t}`)},toggleAllCheckboxes=e=>{toggleCheckboxAnimation("#cookie-marketing","marketing","marketing","marketing",e),toggleCheckboxAnimation("#cookie-analytics","analytics","analytics","analytics",e),toggleCheckboxAnimation("#cookie-personalization","personalization","personalization","personalization",e);const o={essential:!0,analytics:e,marketing:e,personalization:e};cookieManager.setCookie("cta",JSON.stringify(o),cookieConfig.cookieMaxAge)},e=document.querySelectorAll("[cta='allow']");e.length>0&&e.forEach((e=>{e.addEventListener("click",(()=>{toggleAllCheckboxes(!0),uiManager.hideBanner()}))}));const o=document.querySelectorAll("[cta='deny']");o.length>0&&o.forEach((e=>{e.addEventListener("click",(()=>{toggleAllCheckboxes(!1),uiManager.hideBanner()}))}));const n=JSON.parse(cookieManager.getCookie("cta"))||{essential:!0,analytics:!1,marketing:!1,personalization:!1};toggleCheckboxAnimation("#cookie-marketing","marketing","marketing","marketing",n.marketing),toggleCheckboxAnimation("#cookie-analytics","analytics","analytics","analytics",n.analytics),toggleCheckboxAnimation("#cookie-personalization","personalization","personalization","personalization",n.personalization)}));